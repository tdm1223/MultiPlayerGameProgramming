# 인터넷

## 패킷 스위칭의 기원
- 서킷 스위칭
  - 정보를 송수신하는 과정에서 송수신 단말 사이에 회로 연결을 해두고 정보 전달을 수행
  - 회로는 작은 단위의 회선을 길게 짜 맞추어 연결한 것으로 송수신이 일어나는 동안 연결이 유지되는 방식
  - 전화 통화 시 발생하는 큰 뭉치의 데이터를 뉴욕에서 LA까지 서킷 스위칭으로 보내려면 그 사이에 있는 여러 도시의 단거리 회선들을 해당 통신 전용으로 연결해야 함
  - 여러 회선을 이어 길게 연결된 하나의 회로로 만들고 데이터 송수신이 끝날 때까지 연결 상태를 유지
  - 한 번에 하나의 통신 전용으로만 회선을 사용해야 하므로 가용성 면에서 제한적
- 패킷 스위칭
  - 하나의 송수신에 회선을 전용으로 할당해야할 필요가 없어 가용성을 높일 수 있음
  - 회선 자체는 공유하되 송수신 내용을 패킷이라는 작은 뭉치로 나눈 뒤 저장 후 전달 절차를 사용해 보냄
  - 네트워크의 노드는 같은 네트워크의 여러 노드에 연결되는데, 연결된 회선으로 노드 사이에 패킷을 주고받을 수 있음
  - 각각의 노드는 수신한 패킷을 저장하고 목적지에 가까운 다른 노드로 전달
  - 같은 회선을 동시에 이용할 수 있게 되고 한 번에 많은 송수신 패킷을 처리할 수 있어서 가용성이 증대
- 패킷 스위칭은 추상화된 개념에 불과하므로 구체화하기 위해 네트워크의 각 노드가 어떻게 데이터 패킷을 꾸릴지, 어떻게 패킷을 네트워크를 통해 보낼지를 정형화해 둔 프로토콜이 필요함
- 이렇게 발전한 여러 프로토콜을 통칭해 TCP/IP 스택이라 부름

## TCP/IP 스택의 계층 구조
- 목적에 따라 여러 프로토콜을 갈아 끼울 수 있게 계층을 추상화하여 나누었다.
- 각기 독립된 계층이 다른 계층을 뒷받침하고 데이터를 연계할 수 있다.
- 설계 철학에 반하는 예외사항으로 범벅되어 있다.

## 물리 계층
- 하드웨어 전송을 지원하는 계층
- 호스트 사이의 물리적 연결을 책임진다.
- 랜선, 전화선, 동축 케이블, 광섬유 케이블 드잉 물리 계층에서 연결에 이용되는 매체의 예이다.

## 링크 계층
- 물리적으로 연결된 호스트 사이의 통신 수단을 제공한다.
  - 송신 호스트가 정보를 꾸려 물리 계층을 통해 정보를 보낼 수 있는 수단
  - 수신 호스트가 높은 확률로 정보를 수신하여 안에 담긴 정보를 꺼낼 수 있게 하는 수단
- 링크 계층의 송수신 단위는 프레임이다.
- 각 호스트는 링크 계층을 통해 서로에게 프레임을 주고 받는다.
- 링크 계층의 역할
  - 특정 목적지에 주소를 부여해서 각 프레임에 기재토록 하여 호스트를 식별할 수단 제공
  - 수신 측 주소와 데이터를 담을 수 있는 프레임 포맷 정의
  - 한 번에 데이터를 얼마까지 보낼 수 있는지 윗단 계층에서 알 수 있도록 프레임의 최대 길이 정의
  - 물리 계층을 거쳐 전달된 신호를 의도된 호스트가 수신할 수 있게 프레임을 물리적인 전기 신호로 변환하는 방법을 정의
- 의도된 호스트에 프레임이 전달될지 아닐지는 확률적으로 결저되며 항상 보장되는것은 아니다.
- 링크 계층에서는 프레임이 도착하였는지 확인하거나 실패하였을 때 다시 보내는 등의 시도를 하지 않는다. (비신뢰성 통신)

### 1. 이더넷/802.3
- 이더넷 블루북 표준에 근거한 프로토콜 그룹
- 이더넷에선 매체 접근 제어 주소(MAC 주소)를 사용한다.
- 고유한 48비트 숫자로서 이더넷 네트워크에 연결 가능한 장비 하나마다 고유한 값으로 부여된다.
  - 이러한 장비를 네트워크 인터페이스 컨트롤러(NIC)라 부른다.
- MAC 주소는 범용 고유 식별자(UUID)의 일종으로 기기마다 고유한 값을 부여해야 하므로 NIC 제조업체는 하드웨어 제조 과정에서 MAC 주소를 기기에 새겨 넣는다.
- 첫 24비트는 제조업체 식별 코드(OUI)로 IEEE가 제조사마다 고유한 번호를 할당해준다.
- 나머지 24비트를 고유하게 할당하는 일은 제조업체의 몫이다.
- 와이파이나 블루투스 등 대부분 IEEE 802 링크 계층 프로토콜이 MAC 주소를 사용한다.
- 모든 이더넷 패킷은 0x55 7개에 0xD5 1개 총 8바이트의 16진수로 시작하며 이를 프리앰블과 SFD라 한다.
- 밑단 하드웨어는 이진수 패턴을 체크하여 동기화를 맞추고 새 프레임을 받을 준비를 한다.
- 프리앰블과 SFD는 NIC 하드웨어가 걸러내며 프레임을 구성하는 나머지 바이트 열을 이더넷 모듈에 넘겨 처리한다.
- SFD 뒤에 붙는 6바이트는 프레임의 수신자로 설정된 기기의 MAC 주소를 나타낸다.
- 길이/종류 필드는 오버로드하여 길이나 종류 둘 중 하나로 사용한다.
  - 길이 필드로 사용하는 경우 프레임에 포함된 페이로드의 길이를 바이트 단위로 나타낸다.
  - 종류 필드로 사용하는 경우 이더타입 고유 식별자 값을 기록해 페이로드 내 데이터를 어떻게 해석해야 하는지 표시한다.
  - 이더넷 표준은 페이로드의 최대 길이를 1500바이트로 정의해 두었다. (최대 전송 유닛 : MTU)
  - 길이/종류 필드 값이 1500이하인 경우엔 길이로 해석하고 1536 이상인 경우엔 프로토콜 종류로 판단하면 된다.
- 페이로드란 프레임에 담겨 전송되는 데이터 자체를 뜻한다.
  - 원하는 호스트로 전달 하고 싶은 네트워크 계층 패킷이 담겨있다.
- 프레임 체크 시퀀스는 CRC32값으로 여러 값에 걸쳐 연산하여 얻은 체크섬 값이다.
  - 연산에 포함되는 것은 발신자와 수신자의 주소, 길이/종류 필드, 페이로드, 페딩값 등이다.
  - 이더넷 하드웨어가 데이터 수신 시 이 값을 검사하여 전송된 데이터가 손상되었는지 판단 후 손상된 경우 프레임을 폐기해 버린다.

## 네트워크 계층
### 1. IPv4
### 2. IPv6

## 전송 계층
### 1. UDP
### 2. TCP

## 응용 계층
### 1. DHCP
### 2. DNS

## NAT
### 1. NAT 투과